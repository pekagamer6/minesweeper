<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Infinite Minesweeper</title>
  <style>
    body { background: #121212; color: #aaa; font-family: Arial, sans-serif; text-align: center; margin: 0; padding: 20px; }
    h1 { color: #fff; }
    #game { margin: 20px auto; display: inline-block; }
    table { border-collapse: collapse; margin: 20px auto; background: #333; }
    td { width: 30px; height: 30px; border: 1px solid #555; text-align: center; font-weight: bold; cursor: pointer; background: #222; }
    td.revealed { background: #444; }
    td.flag { background: #222 url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAADqAAAAA7pVsrAAAAAElFTkSuQmCC') no-repeat center; }
    td.mine { background: #f00; color: #fff; }
    .num1 { color: #00f; }
    .num2 { color: #0f0; }
    .num3 { color: #f00; }
    .num4 { color: #00c; }
    .num5 { color: #c00; }
    .num6 { color: #0cc; }
    .num7 { color: #000; }
    .num8 { color: #888; }
    #info { margin: 10px; font-size: 1.2em; }
    button { padding: 10px 20px; margin: 10px; font-size: 1em; cursor: pointer; }
  </style>
</head>
<body>
  <h1>Infinite Minesweeper</h1>
  <div id="info">Level: <span id="level">1</span> | Mines: <span id="mines">10</span> | Flags: <span id="flags">0</span> | Time: <span id="timer">0</span>s</div>
  <div id="game"><table id="board"></table></div>
  <button onclick="newGame()">New Game</button>
  <p>Left click to reveal â€¢ Right click to flag</p>

  <script>
    let size = 9;
    let mines = 10;
    let level = 1;
    let board = [];
    let revealed = 0;
    let flags = 0;
    let gameOver = false;
    let timer = 0;
    let interval;

    function newGame() {
      level = 1;
      size = 9;
      mines = 10;
      createBoard();
      updateInfo();
    }

    function createBoard() {
      gameOver = false;
      revealed = 0;
      flags = 0;
      timer = 0;
      clearInterval(interval);
      interval = setInterval(() => timer++, 1000);
      const tb = document.getElementById('board');
      tb.innerHTML = '';
      board = Array.from({length: size}, () => Array(size).fill(0));
      for (let i = 0; i < mines; i++) {
        let r, c;
        do {
          r = Math.floor(Math.random() * size);
          c = Math.floor(Math.random() * size);
        } while (board[r][c] === 'M');
        board[r][c] = 'M';
        for (let dr = -1; dr <= 1; dr++) for (let dc = -1; dc <= 1; dc++) {
          const nr = r + dr, nc = c + dc;
          if (nr >= 0 && nr < size && nc >= 0 && nc < size && board[nr][nc] !== 'M') board[nr][nc]++;
        }
      }
      for (let r = 0; r < size; r++) {
        const tr = tb.insertRow();
        for (let c = 0; c < size; c++) {
          const td = tr.insertCell();
          td.onmousedown = e => handleClick(r, c, e.button);
          td.oncontextmenu = e => e.preventDefault();
        }
      }
      updateInfo();
    }

    function handleClick(r, c, button) {
      if (gameOver) return;
      const td = document.querySelector(`#board tr:nth-child(${r+1}) td:nth-child(${c+1})`);
      if (td.classList.contains('revealed') || td.classList.contains('flag')) return;
      if (button === 2) { // Right click
        td.classList.toggle('flag');
        flags += td.classList.contains('flag') ? 1 : -1;
        updateInfo();
        checkWin();
        return;
      }
      // Left click
      td.classList.add('revealed');
      revealed++;
      if (board[r][c] === 'M') {
        td.classList.add('mine');
        td.textContent = 'ðŸ’£';
        gameOver = true;
        clearInterval(interval);
        alert('Game Over!');
        return;
      }
      if (board[r][c] > 0) td.textContent = board[r][c];
      td.classList.add(`num${board[r][c]}`);
      if (board[r][c] === 0) floodReveal(r, c);
      checkWin();
    }

    function floodReveal(r, c) {
      for (let dr = -1; dr <= 1; dr++) for (let dc = -1; dc <= 1; dc++) {
        const nr = r + dr, nc = c + dc;
        if (nr >= 0 && nr < size && nc >= 0 && nc < size) {
          const td = document.querySelector(`#board tr:nth-child(${nr+1}) td:nth-child(${nc+1})`);
          if (td && !td.classList.contains('revealed') && !td.classList.contains('flag')) handleClick(nr, nc, 0);
        }
      }
    }

    function checkWin() {
      if (revealed + mines === size * size) {
        gameOver = true;
        clearInterval(interval);
        alert('You Win! Proceeding to next level...');
        level++;
        size += 2; // Increase size
        mines += Math.floor(level * 2); // Increase mines
        createBoard();
      }
    }

    function updateInfo() {
      document.getElementById('level').textContent = level;
      document.getElementById('mines').textContent = mines;
      document.getElementById('flags').textContent = flags;
      document.getElementById('timer').textContent = timer;
    }

    newGame();
  </script>
</body>
</html>
